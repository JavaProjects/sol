*{A sample view generated by the Japid Eclipse plugin - will be generated auotmatically}* 
`args String s, int i 
`extends masterLayout.html("myname", 3456) 

<style type="text/css">
#map_canvas {
  height: 100%;
  height: 650px;
}
.error {
color: red;

}
</style>

<script type="text/javascript">

	 var selectedHubId;
	 function checkAddress() {
		 
		 var address = $("#address")[0].value;
		 map.setZoom(12);
		 
		 var geo = new google.maps.Geocoder();
	  	 var geocoderRequest = { address : address 	};
	  	 geo.geocode(geocoderRequest,   function(array, status) {
  			if ( status == google.maps.GeocoderStatus.OK) {
  				var latLng = array[0].geometry.location;
  				map.setCenter(latLng);
  				
  				var marker = new google.maps.Marker({
  	    	        position: latLng,
  	    	        map: map,
  	    	    });
  				
  			}
  		}); 
		 
		 return false;
	 }
	 
	 function selectHub(id) {
		 selectedHubId = id;
		 $('#hubId').val(id);
		 return false;
		 
	 }

      function loadScript() {
        var script = document.createElement('script');
        script.type = 'text/javascript';
        // supported languages https://spreadsheets.google.com/pub?key=p9pdwsai2hDMsLkXsoM05KQ&gid=1 
        script.src = 'http://maps.googleapis.com/maps/api/js?sensor=false&' +
            'callback=initialize&language=en-AU&region=au';
        document.body.appendChild(script);
      }

      window.onload = loadScript;
      
      var infowindow = null;
      var markers = [];
      
      var hubs = [];
      
      var map;
      
      function initialize() {
    	  infowindow = new google.maps.InfoWindow({content: "some content"});
    	  var myOptions = {
    	    zoom: 4,
    	    center: new google.maps.LatLng(-23.70021, 133.88061),      // (-33.9, 151.2),
    	    mapTypeId: google.maps.MapTypeId.ROADMAP
    	  }
    	  // this will display the map
    	  map = new google.maps.Map(document.getElementById("map_canvas"),
    	                                myOptions);
    	  
    	  //$.getJSON('http://localhost:9000/webservices/hubs', function(jsonObj) {
    	  $.getJSON('/webservices/hubs', function(jsonObj) {
    		  var items = [];
              var zIndex = 1; 
    		  $.each(jsonObj, function() {
    		    hubs.push([this.address, this.latitude, this.longitude, zIndex, this.id]);
    		    zIndex++;
    		  });
    		  
    		  setMarkers(map, hubs);
    		  
    		});
    	}

    	/**
    	 * Data for the markers consisting of a name, a LatLng and a zIndex for
    	 * the order in which these markers should display on top of each
    	 * other.
    	 */
    	var beaches = [
    	  ['Hub Address: Bondi Beach', -33.890542, 151.274856, 4],
    	  ['Hub Address: Coogee Beach', -33.923036, 151.259052, 5],
    	  ['Hub Address: Cronulla Beach', -34.028249, 151.157507, 3],
    	  ['Hub Address: Manly Beach', -33.80010128657071, 151.28747820854187, 2],
    	  ['Hub Address: Maroubra Beach', -33.950198, 151.259302, 1]
    	];
    	
    	
    	var infowindows = [];
    	

    	function setMarkers(map, locations) {
    	  // Add markers to the map

    	  // Marker sizes are expressed as a Size of X,Y
    	  // where the origin of the image (0,0) is located
    	  // in the top left of the image.

    	  // Origins, anchor positions and coordinates of the marker
    	  // increase in the X direction to the right and in
    	  // the Y direction down.
    	  var image = new google.maps.MarkerImage('/public/images/beachflag.png',
    	      // This marker is 20 pixels wide by 32 pixels tall.
    	      new google.maps.Size(20, 32),
    	      // The origin for this image is 0,0.
    	      new google.maps.Point(0,0),
    	      // The anchor for this image is the base of the flagpole at 0,32.
    	      new google.maps.Point(0, 32));
    	  var shadow = new google.maps.MarkerImage('/public/images/beachflag_shadow.png',
    	      // The shadow image is larger in the horizontal dimension
    	      // while the position and offset are the same as for the main image.
    	      new google.maps.Size(37, 32),
    	      new google.maps.Point(0,0),
    	      new google.maps.Point(0, 32));
    	      // Shapes define the clickable region of the icon.
    	      // The type defines an HTML &lt;area&gt; element 'poly' which
    	      // traces out a polygon as a series of X,Y points. The final
    	      // coordinate closes the poly by connecting to the first
    	      // coordinate.
    	  var shape = {
    	      coord: [1, 1, 1, 20, 18, 20, 18 , 1],
    	      type: 'poly'
    	  };
    	  for (var i = 0; i < locations.length; i++) {
    	    var beach = locations[i];
    	    var myLatLng = new google.maps.LatLng(beach[1], beach[2]);
    	    var marker = new google.maps.Marker({
    	        position: myLatLng,
    	        map: map,
    	        shadow: shadow,
    	        icon: image,
    	        shape: shape,
    	        title: beach[0],  // this is tooltip content that shows up when hovering over the marker
    	        zIndex: beach[3]
    	    });
    	    
    	    // define content for overlay (infowindow) window
    	    // this is used below in addListener
    	    marker.html = '<div class="marker-address block-message warning"> <p>' + beach[0] + '</p>' +
	        '<div class="alert-actions"><button class="btn small primary" onclick="return selectHub(' + beach[4] + ');">Select This Hub</button> </div>' +
	        
	        '</div>' ; 
    	    
    	    markers.push(marker);
    	    
    	    //var infowindow = new google.maps.InfoWindow({    content: beach[0]});
    	    //infowindows[i] = new google.maps.InfoWindow({    content: beach[0]});
    	    //markers[i] = marker;
    	    
    	    //google.maps.event.addListener(marker, 'click', function() {  infowindow.open(map,marker);});
    	    
    	  }
    	  
    	  for (var i = 0; i < markers.length; i++) {
    		  var marker = markers[i];
    		  google.maps.event.addListener(marker, 'click', function() { 
    			  infowindow.setContent(this.html);
    			  infowindow.open(map,this);
    			  
    		  });
    	  }
    	  
    	  
    	  
    	}
      
    </script>

<div class="page-header">
    <h1>
        Head Office Administration 
    </h1>
    
</div>
<div class="row">
    <div class="span10">
    
    
    <form method="post" action="/HeadOfficeAdminController/handleLearnerInfo" > 
        <fieldset>
          <legend>Learner's Details</legend>
          <div class="clearfix">
            <label for="title">Title</label>
            <div class="input">
              <input type="text" size="30" name="title" id="title" class="xlarge" value='$flash("title")'>
              <span class="error">$error("title")</span>
            </div>
          </div><!-- /clearfix -->
          
          <div class="clearfix">
            <label for="firstName">First Name</label>
            <div class="input">
              <input type="text" size="30" name="firstName" id="firstName" class="xlarge" value='$flash("firstName")'>
              <span class="error">$error("firstName")</span>
            </div>
          </div><!-- /clearfix -->
          
          <div class="clearfix">
            <label for="lastName">Last Name</label>
            <div class="input">
              <input type="text" size="30" name="lastName" id="lastName" class="xlarge" value='$flash("lastName")' >
              <span class="error">$error("lastName")</span>
            </div>
          </div><!-- /clearfix -->
          
            
          <div class="clearfix">
            <label for="email">Email</label>
            <div class="input">
              <input type="text" size="30" name="email" id="email" class="xlarge" value='$flash("email")'>
              <span class="error">$error("email")</span>
            </div>
          </div><!-- /clearfix -->
          
          
          
          
           <div class="clearfix">
            <label for="dob">Date Of Birth </label>
            <div class="input">
          
           <select class="small" id="birthdayDay" name="birthdayDay"><option value="">Day:</option><option value="1">1</option><option value="2">2</option><option value="3">3</option><option value="4">4</option><option value="5">5</option><option value="6">6</option><option value="7">7</option><option value="8">8</option><option value="9">9</option><option value="10">10</option><option value="11">11</option><option value="12">12</option><option value="13">13</option><option value="14">14</option><option value="15">15</option><option value="16">16</option><option value="17">17</option><option value="18">18</option><option value="19">19</option><option value="20">20</option><option value="21">21</option><option value="22">22</option><option value="23">23</option><option value="24">24</option><option value="25">25</option><option value="26">26</option><option value="27">27</option><option value="28">28</option><option value="29">29</option><option value="30">30</option><option value="31">31</option></select>
           
           <select class="small" id="birthdayMonth" name="birthdayMonth"><option value="">Month:</option><option value="1">Jan</option><option value="2">Feb</option><option value="3">Mar</option><option value="4">Apr</option><option value="5">May</option><option value="6">Jun</option><option value="7">Jul</option><option value="8">Aug</option><option value="9">Sep</option><option value="10">Oct</option><option value="11">Nov</option><option value="12">Dec</option></select> 
          
          <select class="small" id="birthdayYear" name="birthdayYear"><option value="">Year:</option>
          <option value="1950">1950</option><option value="1949">1949</option><option value="1948">1948</option><option value="1947">1947</option><option value="1946">1946</option><option value="1945">1945</option><option value="1944">1944</option><option value="1943">1943</option><option value="1942">1942</option><option value="1941">1941</option><option value="1940">1940</option><option value="1939">1939</option><option value="1938">1938</option><option value="1937">1937</option><option value="1936">1936</option><option value="1935">1935</option><option value="1934">1934</option><option value="1933">1933</option><option value="1932">1932</option><option value="1931">1931</option><option value="1930">1930</option><option value="1929">1929</option><option value="1928">1928</option><option value="1927">1927</option><option value="1926">1926</option><option value="1925">1925</option><option value="1924">1924</option><option value="1923">1923</option><option value="1922">1922</option><option value="1921">1921</option><option value="1920">1920</option><option value="1919">1919</option><option value="1918">1918</option><option value="1917">1917</option><option value="1916">1916</option><option value="1915">1915</option><option value="1914">1914</option><option value="1913">1913</option><option value="1912">1912</option><option value="1911">1911</option><option value="1910">1910</option><option value="1909">1909</option><option value="1908">1908</option><option value="1907">1907</option><option value="1906">1906</option><option value="1905">1905</option>
          <option value="1905">1904</option>
          <option value="1905">1903</option>
          <option value="1905">1902</option>
          <option value="1905">1901</option>
          <option value="1905">1900</option>
          <option value="1905">1899</option>
          <option value="1905">1898</option>
          <option value="1905">1897</option>
          
          </select>
          `if (validation.hasError("birthdayDay") || validation.hasError("birthdayMonth") || validation.hasError("birthdayYear") ) {
          <span class="error">Required</span>
          `}
          
          </div>
          </div><!-- /clearfix -->
          
          <div class="clearfix">
            <label for="address">Address</label>
            <div class="input">
              <input type="text" size="30" name="address" id="address" class="xlarge" value='$flash("address")'><button class="btn info" onclick="return checkAddress();">Check Address</button>
              <span class="error">$error("address")</span>
            </div>
          </div><!-- /clearfix -->

        <fieldset>
          <legend>Hubs</legend>
          
          `if (validation.hasError("hubId")) {
            <div class="error" >No Hub was selected. Hub selection is required.</div>
          
          `}
          <div id="map_canvas"> </div>
          
          <input type="hidden" id="hubId" name="hubId" value="" />
          
          
          <div class="actions">
            <input type="submit" value="Submit" class="btn primary">&nbsp;&nbsp;&nbsp;&nbsp;<button class="btn danger" type="reset">Clear All Fields</button>
          </div>
        </fieldset>
      </form>
      
     
     
        
    </div>
    
    
    
    <div class="span4">
        <h3>Secondary content</h3>
        User Story: Head Office Admin takes phone call from a new learner
    and enters the information below. The map shows all the hubs (TODO). 
    As the address is entered, it is checked (TODO) and shown as a marker
    in the map (TODO). Admin selects a hub that is closest to learner's
    location or based on learner's preferences (TODO).
        
        
        
        
    </div>
</div>
